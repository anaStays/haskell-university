--Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 3
--21, 26, 52, 53, 59, 2.2

--21. Ð”Ð°Ð½Ñ‹ Ð´Ð²Ð° ÑÐ¿Ð¸ÑÐºÐ° Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ñ‡Ð¸ÑÐµÐ» Ð¸Ð· n ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¾Ð². Ð’
--Ð¾Ð´Ð½Ð¾Ð¼ ÑÐ¿Ð¸ÑÐºÐµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð³ÐµÐºÑ‚Ð°Ñ€Ð¾Ð², Ð·Ð°ÑÐµÑÐ½Ð½Ñ‹Ñ… Ð¿ÑˆÐµÐ½Ð¸Ñ†ÐµÐ¹, Ð´Ð»Ñ
--i-Ð³Ð¾ Ñ€Ð°Ð¹Ð¾Ð½Ð°, Ð° Ð²Ð¾ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¼ ÑÑ€ÐµÐ´Ð½ÑÑ ÑƒÑ€Ð¾Ð¶Ð°Ð¹Ð½Ð¾ÑÑ‚ÑŒ Ð² Ñ‚Ð¾Ð½Ð½Ð°Ñ….
--ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÑŒ ÑÑ€ÐµÐ´Ð½ÑŽÑŽ ÑƒÑ€Ð¾Ð¶Ð°Ð¹Ð½Ð¾ÑÑ‚ÑŒ Ð¿ÑˆÐµÐ½Ð¸Ñ†Ñ‹ Ð¿Ð¾ Ð²ÑÐµÐ¹
--Ñ‚ÐµÑ€Ñ€Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¸ Ð² Ñ†ÐµÐ»Ð¾Ð¼ Ð¸ Ð¾Ð±Ñ‰ÐµÐµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐ¾Ð±Ñ€Ð°Ð½Ð½Ð¾Ð¹ Ð¿ÑˆÐµÐ½Ð¸Ñ†Ñ‹.
{-# OPTIONS_GHC -Wno-unrecognised-pragmas #-}
{-# HLINT ignore "Move guards forward" #-}


find :: [Double] -> [Double] -> (Double, Double)
find [] [] = (0,0)
find a b = (sf / sum a, sf)
    where
        sf = sum $ zipWith (*) a b
    
a :: [Double]
a = [1.0,2.1,3.3, 5.0]
b :: [Double]
b = [2.0,4.0,6.0, 7.2]


--26. Ð—Ð°Ð´Ð°Ð½Ð¾ Ð½Ð°Ñ‚ÑƒÑ€Ð°Ð»ÑŒÐ½Ð¾Ðµ Ñ‡Ð¸ÑÐ»Ð¾ k, Ð½Ð°Ð¹Ñ‚Ð¸ Ð²ÑÐµ Ð½Ð°Ñ‚ÑƒÑ€Ð°Ð»ÑŒÐ½Ñ‹Ðµ
--Ñ€ÐµÑˆÐµÐ½Ð¸Ñ (x, y) ÑƒÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ñ ð‘¥^2 + ð‘¦^2 = ð‘˜^2. Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ Ð²
--Ð²Ð¸Ð´Ðµ ÑÐ¿Ð¸ÑÐºÐ° ÐºÐ¾Ñ€Ñ‚ÐµÐ¶ÐµÐ¹. Ð ÐµÑˆÐµÐ½Ð¸Ñ (2, 3) Ð¸ (3, 2) Ð¼Ð¾Ð¶Ð½Ð¾ ÑÑ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ
--Ñ€Ð°Ð²Ð½Ñ‹Ð¼Ð¸ Ð¸Ð»Ð¸ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð½Ñ‹Ð¼Ð¸, ÐºÐ°Ðº Ð±ÑƒÐ´ÐµÑ‚ ÑƒÐ´Ð¾Ð±Ð½ÐµÐµ.

ns:: Integer->[(Integer,Integer)]
ns k = [ (a,b) | a <- x, b <- y, a*a + b*b == kk ]
    where
        kk = k*k
        x = [1..k]
        y = [1..k]

test = ns 10


--52. ÐÐ°Ð¹Ñ‚Ð¸ Ð²ÑÐµ Ñ†ÐµÐ»Ñ‹Ðµ Ñ‡Ð¸ÑÐ»Ð° Ð¸Ð· Ð¿Ñ€Ð¾Ð¼ÐµÐ¶ÑƒÑ‚ÐºÐ° Ð¾Ñ‚ a Ð´Ð¾ b, Ñƒ
--ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð´ÐµÐ»Ð¸Ñ‚ÐµÐ»ÐµÐ¹ Ñ€Ð°Ð²Ð½Ð¾ k.

cd :: Int->Int
cd a = length [x | x <- [1..a], mod a x == 0]

fcd :: Int -> Int -> Int -> [Int]
fcd a b k = [ x | x <- [a..b], cd x == k ]

test52 = fcd 1 10 3


--53. ÐÐ°Ñ‚ÑƒÑ€Ð°Ð»ÑŒÐ½Ð¾Ðµ Ñ‡Ð¸ÑÐ»Ð¾ Ð½Ð°Ð·Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Â«ÑÐ¾Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ñ‹Ð¼Â», ÐµÑÐ»Ð¸ Ð¾Ð½Ð¾
--Ñ€Ð°Ð²Ð½Ð¾ ÑÑƒÐ¼Ð¼Ðµ ÑÐ²Ð¾Ð¸Ñ… Ð´ÐµÐ»Ð¸Ñ‚ÐµÐ»ÐµÐ¹, Ð²ÐºÐ»ÑŽÑ‡Ð°Ñ 1 Ð¸ Ð¸ÑÐºÐ»ÑŽÑ‡Ð°Ñ ÑÑ‚Ð¾
--ÑÐ°Ð¼Ð¾Ðµ Ñ‡Ð¸ÑÐ»Ð¾. ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, ÑÐ¾Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ñ‹Ð¼ ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ñ‡Ð¸ÑÐ»Ð¾ 6 (6 =
--1+2+3). ÐÐ°Ð¹Ñ‚Ð¸ Ð²ÑÐµ ÑÐ¾Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ñ‹Ðµ Ñ‡Ð¸ÑÐ»Ð°, Ð¼ÐµÐ½ÑŒÑˆÐ¸Ðµ Ñ‡Ð¸ÑÐ»Ð° n.

d :: Int -> [Int]
d a = [x | x <- [1..a], mod a x == 0]

pn :: Int -> [Int]
pn n = [x | x <- [1..n], sum (d x) - x == x]

test53 = pn 10

--59. Ð“Ð¸Ð¿Ð¾Ñ‚ÐµÐ·Ð° Ð“Ð¾Ð»ÑŒÐ´Ð±Ð°Ñ…Ð° Ð³Ð»Ð°ÑÐ¸Ñ‚, Ñ‡Ñ‚Ð¾ ÐºÐ°Ð¶Ð´Ð¾Ðµ Ð¿Ð¾Ð»Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ
--Ñ‡ÐµÑ‚Ð½Ð¾Ðµ Ñ‡Ð¸ÑÐ»Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐµ 2 ÑÐ²Ð»ÑÐµÑ‚ÑÑ ÑÑƒÐ¼Ð¼Ð¾Ð¹ Ð´Ð²ÑƒÑ… Ð¿Ñ€Ð¾ÑÑ‚Ñ‹Ñ… Ñ‡Ð¸ÑÐµÐ».
--ÐŸÑ€Ð¸Ð¼ÐµÑ€: 28 = 5 + 23. ÐÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ð½Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ð´Ð»Ñ
--Ð½Ð°Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ Ð¿Ð°Ñ€ Ð¿Ñ€Ð¾ÑÑ‚Ñ‹Ñ… Ñ‡Ð¸ÑÐµÐ», ÑÑƒÐ¼Ð¼Ð° ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… Ð´Ð°ÐµÑ‚ Ð·Ð°Ð´Ð°Ð½Ð½Ð¾Ðµ
--Ñ‡ÐµÑ‚Ð½Ð¾Ðµ Ñ†ÐµÐ»Ð¾Ðµ Ñ‡Ð¸ÑÐ»Ð¾, Ð´Ð»Ñ ÑÐ¿Ð¸ÑÐºÐ° Ñ‡Ð¸ÑÐµÐ» Ð¼ÐµÐ¶Ð´Ñƒ Ð´Ð²ÑƒÐ¼Ñ Ñ†ÐµÐ»Ñ‹Ð¼Ð¸
--Ñ‡Ð¸ÑÐ»Ð°Ð¼Ð¸: function 9 20 -> [(3,7),(5,7),(3,11),(3,13),(5,13),(3,17)]

--function :: Int -> Int -> [(Int, Int)]
--function a b = [(x, y) | x <- [1..a], y <- [1..b], cd x == 2, cd y == 2, x + y == b]

--test59 = function 9 20

function1 :: Int -> Int -> [(Int, Int)]
function1 a b = [(x, y) | x <- [1..a], y <- [1..b], cd x == 2, cd y == 2, even (x + y), a <= (x+y), (x+y) <= b ]

test591 = function1 9 20



--2.2 ÐÐ°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ð½Ð°Ñ…Ð¾Ð´ÑÑ‰ÑƒÑŽ ÑÑƒÐ¼Ð¼Ñƒ Ñ€ÑÐ´Ð° Ñ Ð·Ð°Ð´Ð°Ð½Ð½Ð¾Ð¹ Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒÑŽ
--â„‡. Ð’Ñ‹Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ðµ Ð·Ð°ÐºÐ°Ð½Ñ‡Ð¸Ð²Ð°ÐµÑ‚ÑÑ, ÐµÑÐ»Ð¸ Ð¼Ð¾Ð´ÑƒÐ»ÑŒ Ð¾Ñ‡ÐµÑ€ÐµÐ´Ð½Ð¾Ð³Ð¾ ÑÐ»Ð°Ð³Ð°ÐµÐ¼Ð¾Ð³Ð¾
--ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑÑ Ð¼ÐµÐ½ÑŒÑˆÐµ Ð·Ð°Ð´Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚Ð¸ â„‡. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÑ‚ÑŒ
--ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ÑÑ‚ÑŒ Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ð¾ ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»ÑŒÐ½Ð¾Ð¹ Ñ„Ð¾Ñ€Ð¼ÑƒÐ»Ðµ.
--x(2+x)/2! - x^3(4+x)/4! ... x^2i-1(2i+x)/(2i)!
fact:: Int -> Int
fact n = helper n 1
    where
        helper 1 s = s
        helper n s = helper (n-1) (s*n)

tn :: Double -> Int -> Double
tn x n = (-1)^(n - 1) * (x^(2 * n - 1) * (2 * fromIntegral n + x) / fromIntegral (fact (2*n)))

ss :: Double -> Double -> Double
ss x eps = helper 1 0.0
    where
        helper n s
            |abs (tn x n) < eps = s
            |otherwise = helper (n+1) (tn x n +s)

test2_2 = ss 3 0.0001